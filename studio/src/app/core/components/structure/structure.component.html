<mat-toolbar>Game structure</mat-toolbar>

<mat-tree [dataSource]="dataSource" [treeControl]="treeControl">

  <!-- Child nodes -->
  <mat-tree-node *matTreeNodeDef="let node">

    <li class="mat-tree-node leaf" matRipple (contextmenu)="onContextMenu($event, node)">

      <span class="mat-icon-button">
        <mat-icon class="candy-icon">{{node.icon}}</mat-icon>
      </span>

      <span class="name">{{node.name}}</span>

    </li>

  </mat-tree-node>

  <!-- Parent nodes -->
  <mat-nested-tree-node *matTreeNodeDef="let node; when isCategory">

    <li class="mat-tree-node" matRipple>

      <button mat-icon-button matTreeNodeToggle [disabled]="node.children.length === 0" (mousedown)="$event.stopPropagation()">
        <mat-icon>{{treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'}}</mat-icon>
      </button>

      <span class="name" matTreeNodeToggle>{{node.name}}</span>

      <button mat-icon-button *ngIf="node.addAction" (click)="onAdd(node)" (mousedown)="$event.stopPropagation()">
        <mat-icon>add</mat-icon>
      </button>

    </li>

    <ul *ngIf="treeControl.isExpanded(node)">
      <ng-container matTreeNodeOutlet></ng-container>
    </ul>

  </mat-nested-tree-node>

</mat-tree>

<!-- Nodes context menu -->
<div style="visibility: hidden; position: fixed"
     [style.left]="contextMenuPosition.x"
     [style.top]="contextMenuPosition.y"
     [matMenuTriggerFor]="contextMenu">
</div>

<mat-menu #contextMenu="matMenu">

  <ng-template matMenuContent let-node="node">

    <button mat-menu-item *ngIf="node.copyAction" disabled>
      <mat-icon>file_copy</mat-icon>
      Copy
    </button>

    <button mat-menu-item *ngIf="node.deleteAction" disabled>
      <mat-icon>delete</mat-icon>
      Delete
    </button>

  </ng-template>

</mat-menu>


